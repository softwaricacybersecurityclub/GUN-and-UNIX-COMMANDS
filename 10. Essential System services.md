# Maintain System Time
- Keep your computers synchronised and accurate
- Helps with scheduled jobs. e.g. Backups
- Helps caching and logging
- Helps identify when issues may occur
- Time-dependents applications require very accurate clocks

--- 
We can check the date by simply using the `date` command. But, Linux store date in a seperate way i.e. number of seconds since epoch which is the first of january 1970. This is referred to as unix time. 
```bash
date +%s #This shows the current unix time.
```

Any application that uses the date to do any of its processing will usually query the unix time and convert it to the current time zone.

- **ntpdate** 
	- This is used to query a remote time server
	- Set your system clock to it
- **ntpd** 
	- runs daemon on your computer that constantly polls the time servers 
	- Ensures your computer always has the correct time.
	- It can also be used as a lcoal time server for other computers to set their clocks 

```bash
#To install ntpdate
sudo apt-get install ntpdate

#To query pool.ntp.org
sudo ntpdate pool.ntp.org #This is a constantly changing link to an ntp server around the world They constantly change it so they don't overload a single ntp server. After finding a time server it will adjust the time in the device.

#To install the ntp daemon
sudo apt-get install #This automatically runs the ntp in daemon. 

#Location of ntpd
vim /etc/ntpsec/ntp.conf #This has links to different ntp servers that will keep polling different ntp servers at regular intervals to improve precision. It can also detect the difference between clock and the reference clock. And adjust the system time accordingly.

hwclock #hwclock is a utility for accessing the hardware clock also referred to as the real-time clock or rtc the hardware clock is independent of your operating system and runs even when the machine is shut down now. The time and date can differ because we are using kali in vmware which is linked with virtual hardware. It is suggested to keep the hardware clock coordinated with universal time or utc

#To set the hwclock into local time
sudo hwclock --systohc --localtime
# --systohc sets the hardware clock from the system clock and update the timestamps in /etc/adjtime
# --localtime is used to specify the time which are --localtime and --utc
```

# Chrony and Timedatectl
- Chrony
	- Chrony is a versatile implementation of the Network Time Protocol
	- It can also use reference clocks like a GPS receiver
	- It can use manual input using a wristwatch and keyboard.
	- Designed to perform well in a wide range of conditions:
		- Intermittent network connections
		- Changing temperatures
		- Virtual machines

```bash
#To install chrony
sudo apt-get install chrony
```
It should automatically be enabled after download,
```bash
#To check chrony status
systemctl status chronyd

#To check if chrony is synchronized correctly
chronyc tracking

#To start chronyd
systemctl start chronyd

#To see sources of time
chronyc sources
```

#### Timedatectl
This gives local time, universal time(utc), rtc, timezone.
```bash
#We can also set time manually
sudo timedatectl set-time "2022-09-22 10:55:23"

#To check all the possible time zone
timedatectl list-timezones

#To set time according to timezone
sudo timedatectl set-timezone Asia/Kathmandu

#To remove the timedatectl
timedatectl set-ntp false
```

# System logging
- syslog
	- Message logging standard
	- Separates
		- Message generator
		- Message storage
		- Message analyser
	- Each message has a facility code indicating
		- software type 
		- Severity level
	- Used for
		- System management
		- Security auditing
		- General information
		- Analysis
		- Debuggind messages

Syslogd was the syslog system that was widely used by various distributions of linux and unix since then.

```bash
#To check which syslog we are running
ps aux | grep syslog
```

There are different types of syslog files. Syslogs files has split configuration file which helps to keep it managed and edit.

```bash
#Location of syslog file
cd /etc/rsyslog.d/

#To check changes in the syslog
vim /var/log/syslog

```

Logrotate is a utility which helps to deal with logs easier as it rotates them, compresses them, compresses them, removes them, see email logs. Rotating a log means when it gets full logs will compress and rename it to (for e.g. sys1, sys2). This will keep rotating and the numbers will be incremented until you hit a limit of whatever is set in log rotate. When the log is too old it will `deleted.` There are always systembackup log at each stage so that we can recover it from a certain point of time.

```bash
#We can check the log rotate file to see when the logs will be rotated.
vim /etc/logrotate.conf
```

**journalctl** is used to query and display messages from the systemd journal.
```bash
#If we run it with no arguments we can see the full journal
journalctl #It basically is all the important logging messages from each application that systemd is managing
```